#!/usr/bin/env ruby

require 'bundler/setup'
require 'slop'
require 'shiplogs/parser'
require 'pp'

opts = Slop.parse do |o|
  o.banner = 'usage: shiplogs [options] <JSON FILE>'
  o.separator ''
  o.bool '-h', '--help', 'print help'
  o.bool '--simplify', 'simplify the json file'
  o.on '--version', 'print the version' do
    puts Shiplogs::Parser::VERSION
    exit
  end
end

if opts.help?
  puts opts
  exit
end

if opts.simplify?
  filename = opts.arguments.first
  log =  Shiplogs::Parser::OldWeather.new(filename)
  puts log.simplify.to_json
end
